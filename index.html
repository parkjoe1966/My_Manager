<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>My Manager</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root { --gold: #D4AF37; --gold-dark: #B8860B; --black: #0A0A0A; --card-bg: #1A1A1A; --text: #E0E0E0; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: 'Noto Sans KR', sans-serif; background: var(--black); color: var(--text); line-height: 1.6; }
        #home-screen { height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1497215728101-856f4ea42174?auto=format&fit=crop&w=1000'); background-size: cover; background-position: center; text-align: center; }
        #home-screen h1 { font-family: 'Playfair Display', serif; font-size: 3.5rem; color: var(--gold); margin: 0; }
        .enter-btn { margin-top: 50px; padding: 20px 80px; background: var(--gold); color: black; border: none; border-radius: 50px; font-size: 1.4rem; font-weight: 700; cursor: pointer; }
        #main-app { display: none; padding: 20px 20px 120px; max-width: 600px; margin: 0 auto; }
        .tab-content { display: none; animation: fadeIn 0.4s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: var(--card-bg); border-radius: 20px; padding: 25px; margin-bottom: 25px; border: 1px solid #333; }
        h2 { font-family: 'Playfair Display', serif; color: var(--gold); font-size: 1.8rem; margin-top: 0; border-bottom: 1px solid var(--gold-dark); padding-bottom: 10px; }
        label { display: block; font-size: 0.85rem; color: var(--gold); margin: 15px 0 5px; font-weight: 500; }
        input, select, textarea { width: 100%; padding: 14px; background: #252525; border: 1px solid #444; border-radius: 12px; color: white; font-size: 1rem; margin-bottom: 5px; outline: none; }
        textarea { min-height: 80px; resize: none; }
        .save-btn { width: 100%; padding: 18px; background: var(--gold); color: black; border: none; border-radius: 12px; font-weight: 700; font-size: 1.1rem; margin-top: 20px; cursor: pointer; }
        .nav-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(10, 10, 10, 0.95); display: flex; justify-content: space-around; padding: 15px 0; border-top: 1px solid var(--gold-dark); backdrop-filter: blur(15px); z-index: 1000; }
        .nav-item { background: none; border: none; color: #666; font-size: 0.75rem; font-weight: 500; cursor: pointer; }
        .nav-item.active { color: var(--gold); font-weight: 700; }
        .status-tag { display: inline-block; padding: 2px 8px; border-radius: 5px; font-size: 0.75rem; margin-right: 5px; font-weight: bold; margin-top: 5px; }
        .normal { background: #2ecc71; color: white; }
        .caution { background: #f1c40f; color: black; }
        .danger { background: #e74c3c; color: white; }
        .history-item { background: #222; padding: 15px; border-radius: 15px; margin-bottom: 10px; border-left: 5px solid var(--gold); position: relative; cursor: pointer; }
        .del-btn { position: absolute; right: 15px; top: 15px; color: #FF4D4D; background: none; border: none; font-size: 0.8rem; cursor: pointer; z-index: 10; }
        .summary-period { background: #252525; padding: 12px; border-radius: 12px; border: 1px solid #333; margin-bottom: 10px; font-size: 0.85rem; }
    </style>
</head>
<body>

<div id="home-screen">
    <h1>My Manager</h1>
    <p style="color: var(--gold); letter-spacing: 2px;">당신만을 위한 완벽한 인공지능 비서</p>
    <button class="enter-btn" onclick="enterApp()">ENTER</button>
</div>

<div id="main-app">
    <section id="tab-basic" class="tab-content active">
        <h2>Basic Info</h2>
        <div class="card">
            <label>생년월일</label><input type="date" id="birth" onchange="updateAge()">
            <div id="age-box" class="history-item" style="border-color: var(--gold-dark);">만나이: - 세</div>
            <label>성별</label><select id="gender"><option value="남">남성</option><option value="여">여성</option></select>
            <label>키 (cm)</label><input type="number" id="height" step="0.1">
        </div>
        <div class="card">
            <label>건강 관리 목표</label><textarea id="g-health"></textarea>
            <label>자기 계발 목표</label><textarea id="g-dev"></textarea>
            <label>재정 관리 목표</label><textarea id="g-finance"></textarea>
            <button class="save-btn" onclick="saveBasic()">정보 저장 및 동기화</button>
        </div>
    </section>

    <section id="tab-health" class="tab-content">
        <h2>Health Care</h2>
        <div class="card">
            <label>기록 일자</label><input type="date" id="h-date">
            <label>체중 (kg)</label><input type="number" id="h-weight" step="0.1">
            <div style="margin:20px 0;"><canvas id="weightChart"></canvas></div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <div><label>수축기</label><input type="number" id="bp-sys"></div>
                <div><label>이완기</label><input type="number" id="bp-dia"></div>
            </div>
            <label>공복 혈당 (mg/dL)</label><input type="number" id="h-sugar">
            <label>식단 및 운동 메모</label><textarea id="h-meal" placeholder="식단 및 운동 내용 입력"></textarea>
            <button class="save-btn" onclick="saveData('health')">건강 기록 저장</button>
        </div>
        <div id="h-list"></div>
    </section>

    <section id="tab-dev" class="tab-content">
        <h2>Development</h2>
        <div class="card">
            <label>날짜 선택</label><input type="date" id="d-date">
            <label>활동 내용 및 일기</label><textarea id="d-desc"></textarea>
            <button class="save-btn" onclick="saveData('dev')">성장 기록 저장</button>
        </div>
        <div id="d-list"></div>
    </section>

    <section id="tab-finance" class="tab-content">
        <h2>Finance</h2>
        <div class="card">
            <h3 style="color:var(--gold); margin:0 0 10px 0;">Cash Balance Summary</h3>
            <div id="fin-summary-content"></div>
        </div>
        <div class="card">
            <label>날짜 선택</label><input type="date" id="f-date">
            <label>구분</label><select id="f-type"><option value="지출">지출</option><option value="수입">수입</option></select>
            <label>분류</label><select id="f-cat"><option>식비</option><option>교통</option><option>문화</option><option>생활</option><option>기타</option></select>
            <label>내역</label><input type="text" id="f-desc">
            <label>금액</label><input type="number" id="f-amount">
            <button class="save-btn" onclick="saveData('finance')">금융 내역 저장</button>
        </div>
        <div class="card" style="border: 1px solid var(--gold);">
            <h3 style="color:var(--gold); margin:0;">DRTECH (디알텍)</h3>
            <label>매수 단가</label><input type="number" id="stock-buy-price" placeholder="매수가 입력">
            <label>보유 수량</label><input type="number" id="stock-count" placeholder="수량 입력">
            <button class="save-btn" style="background:#222; color:var(--gold); border:1px solid var(--gold);" onclick="saveStock()">주식 정보 저장</button>
        </div>
        <div id="f-list"></div>
    </section>
</div>

<nav class="nav-bar" id="nav" style="display:none;">
    <button class="nav-item active" onclick="showTab('tab-basic')">BASIC</button>
    <button class="nav-item" onclick="showTab('tab-health')">HEALTH</button>
    <button class="nav-item" onclick="showTab('tab-dev')">DEVELOP</button>
    <button class="nav-item" onclick="showTab('tab-finance')">FINANCE</button>
</nav>

<script>
    let db = JSON.parse(localStorage.getItem('myManager_V2')) || { basic: {}, health: [], dev: [], finance: [], stock: {} };
    const todayStr = new Date().toISOString().split('T')[0];

    function syncDB() { localStorage.setItem('myManager_V2', JSON.stringify(db)); }
    function enterApp() { document.getElementById('home-screen').style.display = 'none'; document.getElementById('main-app').style.display = 'block'; document.getElementById('nav').style.display = 'flex'; initApp(); }

    function initApp() {
        document.querySelectorAll('input[type="date"]').forEach(i => i.value = todayStr);
        loadBasic(); renderAll(); if(typeof Chart !== 'undefined') initChart();
    }

    function showTab(id) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if(event) event.currentTarget.classList.add('active');
        renderAll();
    }

    function loadBasic() {
        const b = db.basic; if(b.birth) {
            document.getElementById('birth').value = b.birth; document.getElementById('gender').value = b.gender;
            document.getElementById('height').value = b.height; document.getElementById('g-health').value = b.gH || "";
            document.getElementById('g-dev').value = b.gD || ""; document.getElementById('g-finance').value = b.gF || "";
            updateAge();
        }
        if(db.stock) {
            document.getElementById('stock-buy-price').value = db.stock.price || '';
            document.getElementById('stock-count').value = db.stock.count || '';
        }
    }

    function saveBasic() {
        db.basic = { birth: document.getElementById('birth').value, gender: document.getElementById('gender').value, height: document.getElementById('height').value, gH: document.getElementById('g-health').value, gD: document.getElementById('g-dev').value, gF: document.getElementById('g-finance').value };
        syncDB(); alert('저장 완료');
    }

    function saveStock() {
        db.stock = { price: document.getElementById('stock-buy-price').value, count: document.getElementById('stock-count').value };
        syncDB(); alert('주식 정보가 저장되었습니다.');
    }

    function saveData(type) {
        let item = { id: Date.now() };
        if (type === 'health') {
            item = { ...item, date: document.getElementById('h-date').value, w: parseFloat(document.getElementById('h-weight').value), sys: parseInt(document.getElementById('bp-sys').value), dia: parseInt(document.getElementById('bp-dia').value), sugar: parseInt(document.getElementById('h-sugar').value), meal: document.getElementById('h-meal').value };
        } else if (type === 'dev') {
            item = { ...item, date: document.getElementById('d-date').value, desc: document.getElementById('d-desc').value };
        } else if (type === 'finance') {
            item = { ...item, date: document.getElementById('f-date').value, type: document.getElementById('f-type').value, cat: document.getElementById('f-cat').value, desc: document.getElementById('f-desc').value, amount: parseInt(document.getElementById('f-amount').value) || 0 };
        }
        db[type].push(item); syncDB(); renderAll(); if(type==='health') updateChart();
        alert('기록되었습니다.');
    }

    function deleteRecord(type, id) { if(confirm('삭제하시겠습니까?')) { db[type] = db[type].filter(i => i.id !== id); syncDB(); renderAll(); if(type==='health') updateChart(); } }

    function renderAll() {
        const hList = document.getElementById('h-list'); if(hList) {
            hList.innerHTML = '';
            db.health.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(i => {
                hList.innerHTML += `<div class="history-item"><strong>${i.date}</strong> | ${i.w||'-'}kg | 혈당: ${i.sugar||'-'}<button class="del-btn" onclick="deleteRecord('health', ${i.id})">삭제</button></div>`;
            });
        }
        const dList = document.getElementById('d-list'); if(dList) {
            dList.innerHTML = '';
            db.dev.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(i => {
                dList.innerHTML += `<div class="history-item"><strong>${i.date}</strong><br>${i.desc}<button class="del-btn" onclick="deleteRecord('dev', ${i.id})">삭제</button></div>`;
            });
        }
        const fList = document.getElementById('f-list'); if(fList) {
            fList.innerHTML = '';
            let totalIncome = 0, totalExpense = 0;
            db.finance.forEach(it => { if(it.type==='수입') totalIncome += it.amount; else totalExpense += it.amount; });
            document.getElementById('fin-summary-content').innerHTML = `<div class="summary-period">전체 수입: ${totalIncome.toLocaleString()}원</div><div class="summary-period">전체 지출: ${totalExpense.toLocaleString()}원</div><div class="summary-period" style="color:var(--gold)">현재 잔액: ${(totalIncome - totalExpense).toLocaleString()}원</div>`;
            db.finance.sort((a,b) => new Date(b.date) - new Date(a.date)).forEach(it => {
                fList.innerHTML += `<div class="history-item"><strong>${it.date}</strong> [${it.type}/${it.cat}] ${it.amount.toLocaleString()}원<button class="del-btn" onclick="deleteRecord('finance', ${it.id})">삭제</button></div>`;
            });
        }
    }

    let weightChart;
    function initChart() {
        const ctx = document.getElementById('weightChart').getContext('2d');
        weightChart = new Chart(ctx, { type: 'line', data: { labels: [], datasets: [{ label: '체중', data: [], borderColor: '#D4AF37', tension: 0.3, fill: false }] }, options: { scales: { x: { type: 'time', time: { unit: 'day' } } } } });
        updateChart();
    }
    function updateChart() { if(!weightChart) return; const data = db.health.filter(d => d.w).sort((a,b) => new Date(a.date) - new Date(b.date)).map(d => ({ x: d.date, y: d.w })); weightChart.data.datasets[0].data = data; weightChart.update(); }
    function updateAge() { const b = document.getElementById('birth').value; if(!b) return; const birth = new Date(b); const now = new Date(); let age = now.getFullYear() - birth.getFullYear(); if (now.getMonth() < birth.getMonth() || (now.getMonth() === birth.getMonth() && now.getDate() < birth.getDate())) age--; document.getElementById('age-box').innerText = `만나이: ${age} 세`; }
</script>
</body>
</html>
